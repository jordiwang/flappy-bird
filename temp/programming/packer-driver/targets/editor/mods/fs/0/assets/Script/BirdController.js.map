{"version":3,"sources":["file:///Users/point/projects/flappy-bird/assets/Script/BirdController.ts"],"names":["_decorator","Component","systemEvent","SystemEvent","Vec3","BoxCollider2D","Contact2DType","MainController","GAME_STATE","AudioController","AUDIO_TYPE","ccclass","property","BirdController","type","onLoad","on","EventType","TOUCH_START","onTouchStart","getComponent","BEGIN_CONTACT","onBeginContact","start","update","deltaTime","mainController","gameState","GS_PLAYING","speed","_currentPosition","node","getPosition","y","setPosition","angle","setRotationFromEuler","touch","event","audioController","playAudio","RISE","gameOver","COLLISION","setTimeout","END"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,W,OAAAA,W;AAAgCC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,a,OAAAA,a;AAAeC,MAAAA,a,OAAAA,a;;AAG/FC,MAAAA,c,iBAAAA,c;AAAgBC,MAAAA,U,iBAAAA,U;;AAChBC,MAAAA,e,iBAAAA,e;AAAiBC,MAAAA,U,iBAAAA,U;;;;;;;OAHpB;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBZ,U;;AAK9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;gCAGaa,c,WADZF,OAAO,CAAC,gBAAD,C,UAcHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI;AAAA;AAAA;AAAN,OAAD,C,UAGRF,QAAQ,CAAC;AAAEE,QAAAA,IAAI;AAAA;AAAA;AAAN,OAAD,C,oCAjBb,MACaD,cADb,SACoCZ,SADpC,CAC8C;AAAA;AAAA;;AAAA,yCASnB,CATmB;;AAAA,oDAWT,IAAIG,IAAJ,EAXS;;AAAA;;AAAA;AAAA;;AAmB1CW,QAAAA,MAAM,GAAG;AACLb,UAAAA,WAAW,CAACc,EAAZ,CAAeb,WAAW,CAACc,SAAZ,CAAsBC,WAArC,EAAkD,KAAKC,YAAvD,EAAqE,IAArE;AAEA,eAAKC,YAAL,CAAkBf,aAAlB,EAAiCW,EAAjC,CAAoCV,aAAa,CAACe,aAAlD,EAAiE,KAAKC,cAAtE,EAAsF,IAAtF;AACH;;AAEDC,QAAAA,KAAK,GAAG,CAAE;;AAEVC,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAI,KAAKC,cAAL,CAAoBC,SAApB,KAAkC;AAAA;AAAA,wCAAWC,UAAjD,EAA6D;AACzD,iBAAKC,KAAL,IAAc,IAAd;AAEA,iBAAKC,gBAAL,GAAwB,KAAKC,IAAL,CAAUC,WAAV,EAAxB;AAEA,iBAAKF,gBAAL,CAAsBG,CAAtB,IAA2B,KAAKJ,KAAhC;AAEA,iBAAKE,IAAL,CAAUG,WAAV,CAAsB,KAAKJ,gBAA3B;AAEA,gBAAIK,KAAK,GAAI,KAAKN,KAAL,GAAa,CAAd,GAAmB,EAA/B;;AACA,gBAAIM,KAAK,IAAI,CAAC,EAAd,EAAkB;AACdA,cAAAA,KAAK,GAAG,CAAC,EAAT;AACH;;AAED,iBAAKJ,IAAL,CAAUK,oBAAV,CAA+B,IAAIhC,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe+B,KAAf,CAA/B;AACH;AACJ;;AAEDhB,QAAAA,YAAY,CAACkB,KAAD,EAAeC,KAAf,EAAkC;AAC1C,eAAKT,KAAL,GAAa,CAAb;AAEA,eAAKU,eAAL,CAAqBC,SAArB,CAA+B;AAAA;AAAA,wCAAWC,IAA1C;AACH;;AAEDnB,QAAAA,cAAc,GAAG;AACb,eAAKI,cAAL,CAAoBgB,QAApB;AAEA,eAAKH,eAAL,CAAqBC,SAArB,CAA+B;AAAA;AAAA,wCAAWG,SAA1C;AAEAC,UAAAA,UAAU,CAAC,MAAM;AACb,iBAAKL,eAAL,CAAqBC,SAArB,CAA+B;AAAA;AAAA,0CAAWK,GAA1C;AACH,WAFS,EAEP,GAFO,CAAV;AAGH;;AA5DyC,O;;;;;iBAcD,I;;;;;;;iBAGE,I;;;AA8C/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import { _decorator, Component, Node, systemEvent, SystemEvent, EventTouch, Touch, Vec3, BoxCollider2D, Contact2DType } from 'cc';\nconst { ccclass, property } = _decorator;\n\nimport { MainController, GAME_STATE } from './MainController';\nimport { AudioController, AUDIO_TYPE } from './AudioController';\n\n/**\n * Predefined variables\n * Name = BirdController\n * DateTime = Thu Nov 25 2021 17:53:03 GMT+0800 (中国标准时间)\n * Author = jordiwang\n * FileBasename = BirdController.ts\n * FileBasenameNoExtension = BirdController\n * URL = db://assets/Script/BirdController.ts\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\n *\n */\n\n@ccclass('BirdController')\nexport class BirdController extends Component {\n    // [1]\n    // dummy = '';\n\n    // [2]\n    // @property\n    // serializableDummy = 0;\n\n    //Speed of bird\n    public speed: number = 0;\n\n    private _currentPosition: Vec3 = new Vec3();\n\n    @property({ type: MainController })\n    private mainController: MainController = null;\n\n    @property({ type: AudioController })\n    private audioController: AudioController = null;\n\n    onLoad() {\n        systemEvent.on(SystemEvent.EventType.TOUCH_START, this.onTouchStart, this);\n\n        this.getComponent(BoxCollider2D).on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\n    }\n\n    start() {}\n\n    update(deltaTime: number) {\n        if (this.mainController.gameState === GAME_STATE.GS_PLAYING) {\n            this.speed -= 0.05;\n\n            this._currentPosition = this.node.getPosition();\n\n            this._currentPosition.y += this.speed;\n\n            this.node.setPosition(this._currentPosition);\n\n            let angle = (this.speed / 2) * 30;\n            if (angle <= -30) {\n                angle = -30;\n            }\n\n            this.node.setRotationFromEuler(new Vec3(0, 0, angle));\n        }\n    }\n\n    onTouchStart(touch: Touch, event: EventTouch) {\n        this.speed = 2;\n\n        this.audioController.playAudio(AUDIO_TYPE.RISE);\n    }\n\n    onBeginContact() {\n        this.mainController.gameOver();\n\n        this.audioController.playAudio(AUDIO_TYPE.COLLISION);\n\n        setTimeout(() => {\n            this.audioController.playAudio(AUDIO_TYPE.END);\n        }, 100);\n    }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\n */\n"]}